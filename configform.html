<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
        <meta name="description" content="Описание страницы. Не менее 160 символов. " />
        <meta name="keywords" content="Здесь указываем список ключевых слов, разделенные запятой." />
        <link rel = "stylesheet" href = "configform.css">
        <script
            src="http://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous">
        </script>
        <title>Главная страница</title>
    </head>
    <body> 
        <div class="main"; text-align:rigth;>
            <h3>Настройка конфигурации</h3>
            <div class="elements">
                <p>
                    <label>host</label>
                    <input type="text" size="30" id='host'/>
                </p>
                <p>
                    <label>port</label>
                    <input type="text"  size="30" id='port'/>
                </p>
                <p>
                    <label>user name </label>
                    <input type="text"  size="30" id='username'/>
                </p>
                <p>
                    <label>user password</label>
                    <input type="text" size="30" id="password"/>
                </p>
                <p>
                        <input value="Сохранить" name="buttonSave" type="button" id = "buttonSave"/>
                </p>
            </div>
              <script>
                //   function CreateRequest(){
                //     var Request = false;
                    
                //     if (window.XMLHttpRequest)
                //     {
                //     //Gecko-совместимые браузеры, Safari, Konqueror
                //     Request = new XMLHttpRequest();
                //     }
                //     else if (window.ActiveXObject)
                //     {
                //     //Internet explorer
                //     try
                //     {
                //     Request = new ActiveXObject("Microsoft.XMLHTTP");
                //     } 
                //     catch (CatchException)
                //     {
                //     Request = new ActiveXObject("Msxml2.XMLHTTP");
                //     }
                //     }
                    
                //     if (!Request)
                //     {
                //     alert("Невозможно создать XMLHttpRequest");
                //     }
                    
                //     return Request;
                //     }
                //   var Request = CreateRequest();
                // var request = new XMLHttpRequest();
                // request.open('GET','http://localhost:3000/',true);
                // request.addEventListener('readystatechange', function() {
                // // если состояния запроса 4 и статус запроса 200 (OK)
                // if ((request.readyState==4) && (request.status==200)) {
                //     // например, выведем объект XHR в консоль браузера
                //     console.log(request);
                //     // и ответ (текст), пришедший с сервера в окне alert
                //     console.log(request.responseText);
                //     // получить элемент c id = welcome
                //     var userpassword = document.getElementById("userpassword");
                //     // заменить содержимое элемента ответом, пришедшим с сервера
                //     userpassword.value = request.responseText.config;
                // }
                // }); 
                // 5. Отправка запроса на сервер
                // request.send();
              
                $.getJSON('http://localhost:3000/config', data =>{
                    console.log(data);
                    var host = document.getElementById('host').value = data.config.ftpconfig.host;
                    var port = document.getElementById('port').value = data.config.ftpconfig.port;
                    var username = document.getElementById('username').value = data.config.ftpconfig.user;
                    var password = document.getElementById("password").value = data.config.ftpconfig.password;                
                })

                $('#buttonSave').bind('click', function(){
                                console.log('Нажата');
                                data = {host:document.getElementById('host').value};
                                console.log(data);
                                $.post('http://localhost:3000/saveConfig', data);
                            })
              </script>
        </div>
    </body>
</html>